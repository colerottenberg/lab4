\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{float}
\usepackage{indentfirst}
\usepackage{xcolor}
\usepackage{fmtcount}
\usepackage{geometry}
\geometry{margin=1in}

\lstset{basicstyle=\ttfamily\color{blue}}
\newcommand{\code}[1]{\lstinline|#1|}

\title{EEL 4712C - Digital Design: Lab Report 4}
\author{Cole Rottenberg \\ 11062528}
\date{March 3\textsuperscript{rd}, 2024}

\lstset{
  language=VHDL,
  numbers=left,
  stepnumber=1,
  tabsize=2,
  numbersep=5pt,
  backgroundcolor=\color{white},
  showspaces=false,
  showtabs=true,
  frame=single,
  rulecolor=\color{black},
  captionpos=b,
  breaklines=true,
  breakatwhitespace=true,
  title=\lstname,
}

\begin{document}

\maketitle

% Test VHDL code
\begin{lstlisting}[caption=Test VHDL Code, label=lst:test-vhdl-code]
-- This is a test VHDL code block
library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.STD_LOGIC_ARITH.ALL;

entity test is
    Port ( a : in  STD_LOGIC;
           b : in  STD_LOGIC;
           c : out  STD_LOGIC);
end test;
\end{lstlisting}

% \section*{Prelab Report}

% \subsection*{Prelab Questions}
% % Put all the answers to the prelab questions. These may be scanned using your phone or scanner. Not all prelabs have prelab questions

% \subsection*{Prelab Design and Implementation}
% % Go into detail about how you designed any design parts of the prelab. Then, go into detail about how you implemented any implementation parts of the prelab

% \subsection*{Reflection}
% % Talk about what you learned during the prelab. Bring up anything that was a stumped you for a while. Bring up any accomplishments you were proud of.

% \subsection*{Prelab Homework}
% % Show all work for the Prelab Homework here
% % Show all the work for every step in the Prelab Homework section. Label each part clearly and caption all figures. All simulations must be annotated. Annotation means pointing out particularly important parts of a simulation. This can be done with arrows or textboxes. Simple simulations will not have a lot to talk about, but later simulations will be a lot more complex. Any code written in the prelab should be commented a fair amount.

\section*{Lab Report}

\subsection*{Problem Statement}
% Provide a short informal description of the labâ€™s goals (From the lab assignment)
% If required, specify the system to design.
% - Define the inputs.
% - Define the outputs.
% - Define the function of your system. 
% This section should be 1-2 paragraphs long.
  The lab is broken into 4 individual parts and two groups of two. The first part deals with static timing analysis and the second part deals with implementing a basic VGA driver to display a box on a monitor. The third part deals with implementing a VGA driver to display a moving box on a monitor. The fourth part deals applying the same static timing analysis from the first part to the moving box from the third part.

  The 2\textsuperscript{nd} and 3\textsuperscript{rd} part of the lab are the critical design parts of the lab that help us explore the capabilities of the VGA driver and how to implement it. The first and fourth part are more about understanding the timing of the VGA driver and how to properly implement it. The part two is split into three different entities(primarily), the VGA, the VGA sync generator, and the top level component. The inputs to the top level component are relatively static and aren't changing. The outputs are the VGA signals that are sent to the monitor. The signals sent to the monitor are the h\_sync, v\_sync, and the RGB signals. The system is designed to display a box on the monitor. The sync generator is responsible for generating the sync signals, however the VGA entity is responsible for applying the logic to these signals to display the box on the monitor.

\subsection*{Design}
% Describe the design decisions you made.
% - What components did you use?
% - What signals did you use to connect the components?
% - What algorithms did you use?
% Code Segment or block diagrams may be included here.
% Explain your design choices(pros/cons).
% Any designs made in prelab should be included here but more briefly.
% This section should be 1-2 paragraphs long.

The VGA sync generator is consisted of a single clocked process that iterates through a double condition statement. The first conditionally block check if the \code{h_count} is equal the \code{H_MAX} constant defined in our package. If they are equal to eachother, we reset the counter and go onto the next conditional block, which checks if the \code{v_count} is equal to the \code{V_MAX} constant defined in our package. If they are equal to eachother, we reset the counter and exit the process. However, if we the first conditional is false, we increment the \code{h_count} counter. If the second conditional is false, we increment the \code{v_count} counter. On a conceptual level this builds a sweeping motion across the rows and then columns until the end. The second part of the generator exist outside a process as three conditions for the \code{h_sync}, \code{v_sync}, and \code{video_on} signals.

These signals are then passed up to the VGA entity which uses the \code{h_count} and \code{v_count} signals to determine the position of the box on the screen. The \code{draw} clocked process uses these counts to determine if the current pixel is within the define constants of: \code{CENTER\_X\_START}, \code{CENTER\_X\_END}, \code{CENTER\_Y\_START}, and \code{CENTER\_Y\_END}. If the pixel is within these bounds, the \code{red}, \code{green}, and \code{blue} signals are set to "0111", "0011", and "1011" respectively. Outside of the process, existing within the architecture, the \code{h_sync}, \code{v_sync}, and \code{video_on} signals are being outputted to the top level component.

The design of the 3\textsuperscript{rd} part builds of the previous part as it uses an identical VGA sync generator. The VGA entity is modified and new values are used to move the box across the screen as well as change the direction of the box. We also need to make use of a clock divider to slow down the clock signal to 1Hz. This \code{slow\_clk} signal is then used to drive our \code{obj\_move} process. This process is responsible for moving the box across the screen. The \code{obj\_move} process uses a new set of signals and constants to determine the position of the box on the screen. It also uses logic to control directional changes when the box reaches the vertical or horizontal bounds of the screen.

The top level entity controls the final output of the VGA signals to the monitor. The VGA entity passes the following outputs to the top level entity: \code{h\_sync}, \code{v\_sync}, \code{red}, \code{green}, \code{blue}, and \code{video\_on}. The top level entity then passes these signals to the VGA port which is connected to the monitor. 

\subsection*{Implementation}
% Describe the implementation process.
% Code segments or block diagrams may be included here.
% What time did you need to complete your design?
% This section should be 1-2 paragraphs long.

\subsection*{Testing}
% Describe how you tested your design.
% Did everything work as expected?
% - Did inputs match the expected outputs?
% - Special cases?
% Include if possible, timing diagram of photo/video of the system.

\subsection*{Conclusions}
% Summarize in one paragraph, the work you did, the success and problems you encountered, and how to improve next in the future.
% This section should only be 1 paragraph long.

\section*{Appendix}
% Include all postlab code, screenshots, and simulations here. ALL SIMULATIONS MUST BE ANNOTATED. This means pointing out particularly important parts of a simulation. This can be done with arrows or textboxes. All figures must be captioned. Code should be commented a fair amount.

\end{document}
